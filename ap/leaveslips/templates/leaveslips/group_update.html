{% extends "leaveslips/leaveslip_update.html" %}

{% block leaveslip_script %}
  <script>
    var leaveslip_start = "{{leaveslip.start|date:'c'}}"
    var leaveslip_end = "{{leaveslip.end|date:'c'}}"
	
    $(document).ready(function() {
      today = "{{today|date:'c'}}";   
      events = $('#calendar').fullCalendar('clientEvents');
      for (var i=0; i<events.length; i++) {
        e = events[i];
        // This is exclusive. Try x.isBetween(a, b) || x.isSame(a) || x.isSame(b)
		if(moment(e.start).isBetween(moment.utc(leaveslip_start), moment.utc(leaveslip_end), 'minutes', '[]') || moment(e.end).isBetween(moment.utc(leaveslip_start), moment.utc(leaveslip_end), 'minutes', '[]')){
            e.Color = calendar_color['L'];
        } else {
          e.backgroundColor = "";
        }
      }
      $('#calendar').fullCalendar('render');
      $('#calendar').fullCalendar('gotoDate', today);
    });
  </script>
{% endblock %}