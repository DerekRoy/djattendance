{% extends "lifestudies/base_lifestudies.html" %}

{% block tab1 %} class="active" {% endblock %}

{% block title %}Life Study{% endblock %}

{% block lifestudies_content %}

    {% if profile.trainee %}

        <h3> Life Study Summaries</h3>

        {% if disciplines %}
            {% for discipline in disciplines %}
                {% if discipline.trainee.account_id == profile.pk and discipline.isCompleted == False %}
                    <li> {{discipline.displayForTrainee}} 
                        {% if discipline.getNumSummaryDue > 0 %}
                        <a href="{% url 'summary-create' discipline.pk %}"> New </a>
                        {% endif %}
                    </li>
                    <ul>
                        {% for summary in discipline.summary_set.all %}
                            <li> 
                                {{summary}} 
                                {% if summary.approved == False %}
                                <a href="{% url 'summary-detail' summary.pk %}"> Edit </a>
                                {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endfor %}
        {% endif %}


    {% elif profile.trainingassistant %}

        <h3> Life Study TA View </h3>

        <table>
            <tr>
                <th> </th>
                <th> Name </th>
                <th> Infraction </th>
                <th> Offense </th>
                <th> Quantity </th>
                <th> Still Due </th>
                <th> Due Date </th>  
            </tr>
            {% for discipline in disciplines %}
            {% if discipline.isCompleted == False %}
            <tr>
                <td> 
                    <form action="{% url 'discipline-list' %}" method="post">
                        {% csrf_token %}
                        <input type="checkbox" name="selection" value="{{discipline.pk}}"></input>
                </td>
                <td>{{discipline.trainee.account.get_full_name}}</td>
                <td>{{discipline.infraction}}</td>
                <td>{{discipline.offense}}</td>
                <td>{{discipline.quantity}}</td>
                <td>{{discipline.getNumSummaryDue}}</td>
                <td>{{discipline.due | date:"m/d/y"}}</td>

                {% for summary in discipline.summary_set.all %}
                <td>
                    <a href="{% url 'summary-approve' summary.pk %}"> 
                        {{summary.date_submitted | date:"m/d/y"}}
                    </a>
                </td>
                {% endfor %}
            </tr>
            {% endif %}
            {% endfor %}
        </table>

                        <button type="submit" name="approve" class="btn btn-success">Approve Selected</button>
                        <button type="submit" name="delete" class="btn btn-danger">Delete Selected</button>
                    </form>
                    

    {% endif %}

{% endblock %}
