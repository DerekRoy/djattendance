{% extends "lifestudies/base_lifestudies.html" %}

{% load bootstrap3 %}
{% load staticfiles %}

{% block title %}Life Study{% endblock %}

{% block lifestudies_content %}

<h3> Summary </h3>

<form action="" method="post">
  {% csrf_token %}
  {% bootstrap_form form %}
  <h4>
    <span class="badge alert-info">
      "{{summary.book.name}}" Ch. {{summary.chapter}}
    </span>            
  </h4>
  <h4>
    <span class="badge alert-info">
      {{summary.date_submitted}}
    </span>
  </h4>
  {% if summary.approved == False %}
  <button id="summary_submit" disabled="true" type="submit" class="btn btn-success">Update</button>
  {% endif %}
</form>

<script>
  // Word counter
  // First append the word count span
  var content = $('#id_content');
  var wc_text = $(document.createElement('b')).html('Word Count: ');
  var wc_span = $(document.createElement('span')).html('0');
  wc_span.attr('id', 'count');

  content.after(wc_text)
  wc_text.after(wc_span);
  wc_span.after('<br />');

  Countable.live(content.get(0), function(counter){
      var span = document.getElementById('count');
      span.innerHTML = counter.words;
      $("#summary_submit").get(0).disabled = counter.words>=200?false:true;
  })
</script>

{% endblock %}

{% block scripts %}
    <script src="{% static 'js/Countable.js' %}"></script>
{% endblock %}