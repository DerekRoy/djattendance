{% extends "base.html" %}

{% load staticfiles %}
{% load exam_extras %}

{% block references %}
    <link rel="stylesheet" href="{% static 'exams/css/exams.css' %}" />    
{% endblock %}

{% block title %}Exam{% endblock %}

{% block content %}

{% if user.trainee %}
    <div class="panel panel-default">
        <div class="panel-heading">
            <div class="btn-group pull-right">
                {% if role|is_taking_exam %}
                    <a href="{% url 'exams:exam_template_list' %}">
                        <button type="button" class="btn btn-default">Back</button></a>
                {% else %}
                    <a href="{% url 'exams:single_exam_grades' exam.id %}">
                        <button type="button" class="btn btn-default">Back</button></a>
                {% endif %}
            </div>
            <h3 class="panel-title">{{ exam }}</h3>
        </div>
        <div class="panel-body">
        {% if exam_not_available %}
            <i>Sorry, this exam is unavailable to you at this time.</i>
        {% else %}
            <form action="" method="post">
                {% csrf_token %}
                <ol id="ol">
                    {% for question, response in data %}
                        <script>
                            render_question('{{ question|safe }}', '{{ response|safe }}', '{{ role }}', '{{ forloop.counter }}')
                        </script>
                    {% empty %}
                        <i>No exam questions to view.</i><br />
                    {% endfor %}
                </ol>
                <button type="submit" name="Save" class="btn btn-default">Save</button>
                <button type="submit" name="Submit" class="btn btn-default">
                    {% if role|is_taking_exam %}
                        Submit
                    {% else %}
                        Finalize
                    {% endif %}
                </button>
            </form>
        {% endif %}

        </div>
    </div>
{% else %}
<i>Sorry, you cannot take the exam.</i>
{% endif %}

{% endblock %}

{% block scripts %}
    <script src="{% static 'exams/js/word-count.js' %}"></script>
    <script src="{% static 'exams/js/question-display.js' %}"></script>
{% endblock %}