{% extends "exams/base_exams.html" %}

{% load staticfiles %}
{% block title %}Create exam{% endblock %}

{% block scripts %}
<script type="text/javascript" src="{% static "exams/js/exam-create-save-post.js" %}"></script>
<script>
    function GetDynamicTextBox(value) {
        if (value === "essay") {
            return $('#essay-question-template').html();
        } else if (value === "mc") {
            return $('#mc-question-template').html();
        } else if (value === "matching") {
            return $('#matching-question-template').html();
        } else if (value === "tf") {
            return $('#tf-question-template').html();
        }
    }

    $(document).ready(function (e) {
        var iCnt = 0;
        $("#btnAddEssayQuestion").bind("click", function () {
            iCnt = iCnt + 1;
            var div = $('<div id="essay-question-template" />');
            div.html(GetDynamicTextBox("essay"));
            $("#EssayQuestionsContainer").append(div);
        });

        $("#btnAddMCQuestion").bind("click", function () {
            iCnt = iCnt + 1;
            var div = $('<div id="mc-question-template" />');
            div.html(GetDynamicTextBox("mc"));
            $("#MCQuestionsContainer").append(div);
        });

        $("#btnAddMatchingQuestion").bind("click", function () {
            iCnt = iCnt + 1;
            var div = $('<div id="matching-question-template" />');
            div.html(GetDynamicTextBox("matching"));
            $("#MatchingQuestionsContainer").append(div);
        });

        $("#btnAddTFQuestion").bind("click", function () {
            iCnt = iCnt + 1;
            var div = $('<div id="tf-question-template" />');
            div.html(GetDynamicTextBox("tf"));
            $("#TFQuestionsContainer").append(div);
        });

        $("body").on("click", ".remove", function () {
            $(this).closest("div").remove();
        });
    });

    function filterQuestion() {
        var sectiontype = document.getElementById("section-type").value;
        var essaytextarea = document.getElementById("question-prompt");
        if (sectiontype === "essay") {
            essaytextarea.show();
        } else {
            essaytextarea.hide();
        }
    }

</script>

{% endblock scripts %}


{% block content %}

<div class="question-form-container">
<div class="well well-sm small-bottom clearfix hidden" id="essay-question-template">
    <button type="button" class="close remove" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <div class="form-horizontal">
        <div class="form-group right-push col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <div class="input-group">
                <div class="input-group-addon">Points</div>
                <input type="text" name="question-point" class="question form-control" placeholder="1" required=""/>
            </div>
        </div>
        <!-- <div class="spacer" style="float:left; height:20px; width:30px;"></div> -->
        <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2">
            <div name="question-type" class="question form-control" value="essay">Essay</div>
        </div>
        <div class="form-group no-bottom col-xs-12 col-sm-12">
            <textarea name="question-prompt" class="question form-control" placeholder="Enter question prompt"></textarea>
        </div>
    </div>
</div>
</div>

<div class="question-form-container">
<div class="well well-sm small-bottom clearfix hidden" id="mc-question-template">
    <button type="button" class="close remove" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <div class="form-horizontal">
        <div class="form-group right-push col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <div class="input-group">
                <div class="input-group-addon">Points</div>
                <input type="text" name="question-point" class="question form-control" placeholder="1" required=""/>
            </div>
        </div>
        <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2">
            <div name="question-type" class="question form-control" value="mc">Multiple Choice</div>
        </div>
        <!-- <div class="spacer" style="float:left; height:20px; width:30px;"></div> -->
        <div class="form-group no-bottom col-xs-12 col-sm-12">
            <textarea name="question-prompt" class="question form-control" placeholder="Enter question prompt"></textarea>
        </div>
        <div class="form-group right-push col-xs-6 col-sm-6 col-md-6 col-lg-6" id="MCCheckboxes">
            <li><input type="checkbox" name="A" value=""> <textarea name="question-option" class="question form-control" placeholder="Enter choice A"></textarea></li>
             <li><input type="checkbox" name="B" value=""> <textarea name="question-option" class="question form-control" placeholder="Enter choice B"></textarea></li>
             <li><input type="checkbox" name="C" value=""> <textarea name="question-option" class="question form-control" placeholder="Enter choice C"></textarea></li>
             <li><input type="checkbox" name="D" value=""> <textarea name="question-option" class="question form-control" placeholder="Enter choice D"></textarea></li>
             <li><input type="checkbox" name="E" value=""> <textarea name="question-option" class="question form-control" placeholder="Enter choice E"></textarea></li>
        </div>

    </div>
</div>

<div class="question-form-container">
<div class="well well-sm small-bottom clearfix hidden" id="matching-question-template">
    <button type="button" class="close remove" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <div class="form-horizontal">
        <div class="form-group right-push col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <div class="input-group">
                <div class="input-group-addon">Points</div>
                <input type="text" name="question-point" class="question form-control" placeholder="1" required=""/>
            </div>
        </div>
        <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2">
            <div name="question-type" class="question form-control" value="matching">Matching</div>
        </div>
        <!-- <div class="spacer" style="float:left; height:20px; width:30px;"></div> -->
        <div class="form-group no-bottom col-xs-2 col-sm-2 left-push" style="float:left">
            <textarea name="question-prompt" class="question form-control" placeholder="I am crucified with Christ"></textarea>
        </div>
        <div class="form-group no-bottom col-xs-2 col-sm-2 left-push" style="float:left">
            <textarea name="question-match" class="question form-control" placeholder="Gal 2:20"></textarea>
        </div>
    </div>
</div>
</div>

<div class="question-form-container">
<div class="well well-sm small-bottom clearfix hidden" id="tf-question-template">
    <button type="button" class="close remove" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
    </button>
    <div class="form-horizontal">
        <div class="form-group right-push col-xs-12 col-sm-12 col-md-6 col-lg-4">
            <div class="input-group">
                <div class="input-group-addon">Points</div>
                <input type="text" name="question-point" class="question form-control" placeholder="1" required=""/>
            </div>
        </div>
        <div class="form-group col-xs-2 col-sm-2 col-md-2 col-lg-2">
            <div name="question-type" class="question form-control" value="tf">True False</div>
        </div>
        <!-- <div class="spacer" style="float:left; height:20px; width:30px;"></div> -->
        <div class="form-group no-bottom col-xs-12 col-sm-12">
            <textarea name="question-prompt" class="question form-control" placeholder="Enter true-false statement"></textarea>
        </div>
        <div class="form-group no-bottom col-xs-12 col-sm-12">
            <input type='radio' name='tf'> True <br>
            <input type='radio' name='tf'> False <br>
        </div>
    </div>
</div>
</div>

<div class="hidden template2">
    <input class="form-control question" id="question-prompt" type="text" name="question-prompt">
    <input class="form-control point" type="text" name="question-point">
    <select class="form-control type" name="question-type">
        <option value="essay">Essay</option>
    </select>
    <input class="remove btn btn-info-outline" type="button" value="Remove question">
    <br>
    <br>
</div>

<form action="" id="surveyForm" method="post" class="form-horizontal">
    <fieldset>
        {% csrf_token %}

        <h3>{% if exam_not_available %}Create Exam{% else %}Edit Exam: {{ trainingclass }}{% endif %} - Settings <div class="pull-right">
            <a href="{% url 'exams:manage' %}"class="btn btn-default">
                Back
            </a>

            <button id="" name="" class="btn btn-success">
                {% if exam_not_available %}
                Create Exam
                {% else %}
                Save Exam
                {% endif %}
            </button>

        </div></h3>
        <hr>

        {% if exam_not_available %}
        <div class="form-group">
            <label class="col-md-2 control-label" for="selectclass">Select Class</label>
            <div class="col-md-4">
                <select id="selectclass" name="training-class" class="form-control">
                    {% for class in classes %}
                    <option value="{{ class.id }}">{{ class }}</option>
                    {% empty %}
                    <i>No classes to display.</i>
                    {% endfor %}
                </select>
            </div>
        </div>
        {% endif %}

        <div class="form-horizontal">

        <div class="form-group">
            <label class="col-md-2 control-label" for="selectterm">Select Term</label>
            <div class="col-md-4">
                <select id="selectterm" name="term" class="form-control">
                    {% for term in terms %}
                    <option value="{{ term.id }}">{{ term }}</option>
                    {% empty %}
                    <i>No terms to display.</i>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="col-md-2 control-label" for="textinput">Exam Description</label>
            <div class="col-md-4">
                <input id="textinput" name="exam_description" type="text" placeholder="" class="form-control input-md" required="" value="{{ exam_description }}">
            </div>
        </div>

        <!-- Is the exam open -->
        <div class="form-group">
            <label class="col-md-2 control-label" for="radios">Is exam open?</label>
            <div class="col-md-4">
                <div class="btn-group" data-toggle="buttons">
                    <label class="btn btn-default {% if not exam_not_available and is_open %}active{% endif %}">
                        <input type="radio" autocomplete="off" name="is-open" id="radios-0" value="True" {% if not exam_not_available and is_open %}checked{% endif %}> Yes
                    </label>
                    <label class="btn btn-default {% if not exam_not_available and not is_open %}active{% endif %}">
                        <input type="radio" autocomplete="off" name="is-open" id="radios-1" value="False" {% if not exam_not_available and not is_open %}checked{% endif %}> No
                    </label>
                </div>
            </div>
        </div>

        <!-- Exam Category -->
        <div class="form-group">
            <label class="col-md-2 control-label" for="radios">Category</label>
            <div class="col-md-4">
                <div class="btn-group" data-toggle="buttons">
                    <label class="btn btn-default {% if not exam_not_available and not is_final %}active{% endif %}">
                        <input type="radio" autocomplete="off" name="exam-category" id="radios-0" value="M" {% if not exam_not_available and not is_final %}checked{% endif %}> Midterm
                    </label>
                    <label class="btn btn-default {% if not exam_not_available and is_final %}active{% endif %}">
                        <input type="radio" autocomplete="off" name="exam-category" id="radios-1" value="F" {% if not exam_not_available and is_final %}checked{% endif %}> Final
                    </label>
                </div>
            </div>
        </div>

        <!-- Exam duration-->
        <div class="form-group">
            <label class="col-md-2 control-label" for="">Exam duration </label>
            <div class="col-md-4">
                <div class="input-group">
                    <input id="" name="duration" type="text" placeholder="" class="form-control input-md" required="" value="{{ duration }}">
                    <div class="input-group-addon">Minutes</div>
                </div>

            </div>
        </div>
<!--
        <div class="form-group">
            <label class="col-md-2 control-label" for="">Questions</label>
        </div> -->

    </div>

    <h3>Essay Questions <div class="pull-right" id="essayquestionheader">
        <input id="btnAddEssayQuestion" class="btn btn-primary" type="button" value="Add Question" />
    </div></h3>
    <hr>

    <div id="EssayQuestionsContainer">
            <!-- questions are added here -->
    </div>

    <div><h3>Multiple Choice Questions <div class="pull-right" id="mcquestionheader">
        <input id="btnAddMCQuestion" class="btn btn-primary" type="button" value="Add Question" />
    </div></h3>
    <hr></div>

    <div id="MCQuestionsContainer">
            <!-- questions are added here -->
    </div>

    <h3>Matching Questions <div class="pull-right" id="matchingquestionheader">
        <input id="btnAddMatchingQuestion" class="btn btn-primary" type="button" value="Add Question" />
    </div></h3>
    <hr>

    <div id="MatchingQuestionsContainer">
            <!-- questions are added here -->
    </div>

    <h3>True/False Questions <div class="pull-right" id="tfquestionheader">
        <input id="btnAddTFQuestion" class="btn btn-primary" type="button" value="Add Question" />
    </div></h3>
    <hr>

    <div id="TFQuestionsContainer">
            <!-- questions are added here -->
    </div>

<!--         TODO Change to be able to add different types of questions -->
        <div id="qBox" >
            {% for question in data %}
            <div class="well well-sm small-bottom clearfix" id="question-template">
                <button type="button" class="close remove" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <div class="form-horizontal">
                    <div class="form-group right-push col-xs-12 col-sm-12 col-md-6 col-lg-4">
                        <div class="input-group">
                            <div class="input-group-addon">Points</div>
                            <input type="text" name="question-point" class="question form-control" placeholder="1" required="" value="{{ question.points }}"/>
                        </div>
                    </div>
                    <!-- <div class="spacer" style="float:left; height:20px; width:30px;"></div> -->
                    <div class="form-group right-push col-xs-12 col-sm-12 col-md-6 col-lg-4">
                        <div class="input-group">
                            <div class="input-group-addon">Type</div>
                            <select name="question-type" class="question form-control">
                                <option value="essay">Essay</option>
                                <option value="multiplechoice">Multiple Choice</option>
                                <option value="matching">Matching</option>
                                <option value="truefalse">True/False</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group no-bottom col-xs-12 col-sm-12">
                        <textarea name="question-prompt" class="question form-control" placeholder="Enter question prompt">{{ question.prompt }}</textarea>
                    </div>
                </div>
            </div>

                <script>
                    //render_question_for_edit('{{ question|safe }}', '{{ forloop.counter }}')
                </script>
            {% empty %}
            {% endfor %}
        </div>

        <!-- Create Exam Button -->
        <div class="form-group" id="exam-submit">
            <div class="col-md-4">
                <button id="" name="" class="btn btn-success">
                    {% if exam_not_available %}
                        Create Exam
                    {% else %}
                        Save Exam
                    {% endif %}
                </button>
            </div>
        </div>
    </fieldset>
</form>

{% endblock %}

